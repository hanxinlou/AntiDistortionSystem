
# TODO
- [x] 实现图像畸变算法，输入一张图，输入参数，输出畸变后的图。
- [x] 反畸变算法，输入一张图，输入透镜参数。
- [x] 实现拟合算法，输入原图，输入畸变图，输出透镜参数。
- [x] 输出比较图，标红，相减等。
- [x] 尝试优化畸变校正的适应值计算。
- [x] 尝试提供视频畸变转换功能。
- [ ] 实现遗传策略的不同方法。

# 命令行参数
`--img` 指定输入图片路径。

`--video` 指定输入视频路径。

`--video_progress` 指定输入视频的采样点，范围为0~1。

`--output` 指定输出结果的目录。

`--k1 ... --k2 ...` 指定透镜的畸变畸变系数。

`--cx ... --cy ...` 指定透镜的畸变中心。范围为0~1。

`--mode [fit|correct|simple|anti|cmp]` 选择运行模式，`fit`为指定未畸变图片与畸变图片，计算透镜的畸变参数；`correct`为指定未畸变图片与透镜参数，计算反畸变参数；`simple`为指定未畸变图，透镜的畸变参数，输出畸变的图片或视频；`anti`为指定畸变参数、反畸变参数，输出图片或视频。

## 算法专用参数
### 遗传算法
`--ga_m 0.6`变异概率

`--ga_c 0.08`交叉概率

`--pop 50`种群大小

`--gen 40`演化代数

#### 退火算法

`--use_saa`启用退火算法

`--saa_begin_t 3000`起始退火温度

`--saa_end_t 1`终止退火温度

`--saa_delta 0.97`温度变化率

### 演化策略

`--use_es`启用演化策略

`--pop 100`种群大小

`--gen 40`演化代数

## 模式专用参数

### fit
支持`--img`或`--video`作为未畸变图像。

可选参数`--fit_target` 目标拟合图像路径（仅支持图片）或`--k1` `--k2` `--cx` `--cy`作为透镜参数。

支持模拟遗传退火算法或演化策略。

### correct
支持`--img`或`--video`作为未畸变图像。

需要参数`--k1` `--k2` `--cx` `--cy`作为透镜参数。

可选参数`--convert_video`在矫正结束后处理原视频。

支持模拟遗传退火算法或演化策略。

### simple
支持`--img`或`--video`。
需要参数`--k1` `--k2` `--cx` `--cy`。

### anti
支持`--img`或`--video`。

需要参数`--k1` `--k2` `--cx` `--cy`。

需要反畸变参数`--ak1` `--ak2` `--acx` `--acy`。

### cmp
支持`--img`作为原图片。

需要参数`--cmp_target`作为对比图片。

# 典型场景
## 简单畸变图像
`--mode simple --img mypicture.png --output ./output --cx 0.3 --cy 0.6 --k1 0.5 --k2 -0.01`

## 计算透镜参数
`--mode fit --img mypicture.png --fit_target my_dis_picture.png --output ./output`

## 矫正畸变图像
`--mode correct --img mypicture.png --output ./output --cx 0.3 --cy 0.6 --k1 0.5 --k2 -0.01`  
通常传入拟合计算出来的透镜参数。

# 注意
* 路径若存在空格，需要用双引号包裹。